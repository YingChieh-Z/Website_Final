<html>
    <head>
        <link rel = "stylesheet" href = "CSS_Level5.css">
        <title>äºŒå…ƒä¸€æ¬¡æ–¹ç¨‹å¼å­¸ç¿’ç¶²é </title>
        <script>
            var score = 0;
            var stateid = 0;
            var sec = 0;
            var index;
            var TimerID;// ç”¨ä¾†å­˜å„²è¨ˆæ™‚å™¨çš„ ID
            var CountDownID;
            var learningRecord = "";
            var tmpString = "";
            var rightAnswer = "";
            var arr1 = [ "é¸æ“‡æŒ‘æˆ°æ¨¡å¼",
                         "æ­£å¸¸ä½œç­”æ¨¡å¼"+"<span id = 'adjust'>&ensp;&ensp;æ¸¬é©—æ™‚é–“ï¼š<span id = 'time'></span>ç§’&ensp;&ensp;<span id = 'count'>ç›®å‰ç´¯è¨ˆåˆ†æ•¸ï¼š0åˆ†</span></span>"+
                         "<span id = 'feedback'>å›é¥‹ï¼š</span>"+
                         "<button id = 'check' onclick = 'check1();'>æª¢æŸ¥ç­”æ¡ˆ</button>"+
                         "<button id = 'next' onclick = 'next1();'>ä¸‹ä¸€é¡Œ</button><br>",
                         "é™æ™‚ä½œç­”æ¨¡å¼"+"<span id = 'adjust'>&ensp;&ensp;æ¸¬é©—æ™‚é–“ï¼š<span id = 'time'></span>ç§’&ensp;&ensp;å€’æ•¸è¨ˆæ™‚ï¼š<span id = 'CountDown'></span>ç§’&ensp;&ensp;<span id = 'count'>ç›®å‰ç´¯è¨ˆåˆ†æ•¸ï¼š0åˆ†</span></span>"+
                         "<span id = 'feedback'>å›é¥‹ï¼š</span>"+
                         "<button id = 'check' onclick = 'check2();'>æª¢æŸ¥ç­”æ¡ˆ</button>"+
                         "<button id = 'next' onclick = 'next2();'>ä¸‹ä¸€é¡Œ</button><br>"];
            var arr2 = [ "<ul>"+
                         "<button id = 'normal' onclick = 'NormalVersion();'>æ­£å¸¸ä½œç­”æ¨¡å¼</button>"+
                         "<button id = 'timeLimit' onclick = 'timeLimitVersion();'>é™æ™‚ä½œç­”æ¨¡å¼</button></ul><br>"+
                         "è«‹æ³¨æ„ï¼š<br>&ensp;&ensp;é»é¸æ¨¡å¼å¾Œï¼Œæœƒç«‹å³é–‹å§‹æ¸¬é©—ï¼<br>&ensp;&ensp;åŒæ™‚ï¼Œä¸è«–ä½•ç¨®æ¨¡å¼ï¼Œæœªæª¢æŸ¥ç­”æ¡ˆè¦–ç‚ºæœªä½œç­”ï¼"];
            var order = [];
            var Q = [ "<ul>ä¸‹åˆ—å“ªä¸€å€‹é¸é …å…§çš„xã€yå€¼æœƒä½¿å¾—7xï¼9yä¹‹å€¼æœ€å¤§ï¼Ÿ<br><br>"+
                      "<ul><form name = 'myForm1' id = 'A1'>"+
                                "&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;<input type ='radio' id = 'choice2_1' name = 'options' value = 'A'>A. xï¼4ï¼Œyï¼5"+
                                "&ensp;&ensp;<input type ='radio' id = 'choice2_2' name = 'options' value = 'B'>B. xï¼1âˆ•3ï¼Œyï¼1âˆ•5<br><br>"+
                                "&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;<input type ='radio' id = 'choice2_3' name = 'options' value = 'C'>C. xï¼ï¼0.3ï¼Œyï¼ï¼5âˆ•2"+
                                "&ensp;&ensp;<input type ='radio' id = 'choice2_4' name = 'options' value = 'D'>D. xï¼2ï¼Œyï¼ï¼3"+
                      "</form></ul></ul><br>",
                      "<ul>æ›‰éˆ´çš„éŒ¢åŒ…å…§æœ‰åå…ƒç¡¬å¹£xå€‹ï¼Œäº”å…ƒç¡¬å¹£yå€‹ï¼Œè«‹å•éŒ¢åŒ…å…§æœ‰å¤šå°‘å…ƒï¼Ÿ<br><br>"+
                      "<ul><form name = 'myForm2' id = 'A2'>"+
                                "&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;<input type ='radio' id = 'choice3_1' name = 'options' value = 'A'>A. xï¼‹y"+
                                "&ensp;&ensp;<input type ='radio' id = 'choice3_2' name = 'options' value = 'B'>B. 10xï¼‹y<br><br>"+
                                "&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;<input type ='radio' id = 'choice3_3' name = 'options' value = 'C'>C. 10xï¼‹5y"+
                                "&ensp;&ensp;<input type ='radio' id = 'choice3_4' name = 'options' value = 'D'>D. 10ï¼ˆxï¼‹5yï¼‰"+
                      "</form></ul></ul><br>",
                      "<ul>è‹¥è¯ç«‹æ–¹ç¨‹å¼<img src = 'testimg_4.png' id = 'testImg4' width = '150px' height = '90px'>çš„è§£ç‚ºxï¼3ï¼Œyï¼5ï¼Œå‰‡ä¸‹åˆ—ä½•è€…æ­£ç¢ºï¼Ÿ<br><br>"+
                      "<ul><form name = 'myForm3' id = 'A3'>"+
                                "&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;<input type ='radio' id = 'choice3_1' name = 'options' value = 'A'>A. bæ˜¯è³ªæ•¸"+
                                "&ensp;&ensp;<input type ='radio' id = 'choice3_2' name = 'options' value = 'B'>B. aï¼‹bï¼0<br><br>"+
                                "&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;<input type ='radio' id = 'choice3_3' name = 'options' value = 'C'>C. abæ˜¯3çš„å€æ•¸"+
                                "&ensp;&ensp;<input type ='radio' id = 'choice3_4' name = 'options' value = 'D'>D. aï¼bï¼0"+
                      "</form></ul></ul><br>",
                      "<ul>è‹¥yï¼ï¼3xï¼‹4ï¼Œå‰‡2xï¼5yï¼‹1å¯ä»¥ç”¨xè¡¨ç¤ºç‚º&ensp;<input type = 'text' id = 'A4'></ul><br>",
                      "<ul>é˜¿ç‰ç­ä¸Šçš„ç”·ç”Ÿäººæ•¸æ¯”å¥³ç”Ÿäººæ•¸çš„3å€å°‘10äººï¼Œå¥³ç”Ÿäººæ•¸çš„2å€ç­‰æ–¼ç”·ç”Ÿäººæ•¸ï¼Œ<br>å‡è¨­ç”·ç”Ÿæœ‰xäººï¼Œå¥³ç”Ÿæœ‰yäººï¼š<br><br>"+
                      "<ul>ï¼ˆ1ï¼‰è«‹åˆ—å‡ºè¯ç«‹æ–¹ç¨‹å¼ï¼ˆç”¨åŠå½¢é€—è™Ÿé–“éš”å…©å¼ï¼‰ï¼š&ensp;<input type = 'text' id = 'A5'><br><br>"+
                      "ï¼ˆ2ï¼‰ï¼ˆx,yï¼‰ï¼&ensp;<input type = 'text' id = 'A6'><br></ul></ul><br><br>",
                      "<ul>å“¥å“¥èˆ‡å¼Ÿå¼Ÿå„æœ‰æ•¸å¼µç´€å¿µå¡ã€‚å·²çŸ¥å¼Ÿå¼Ÿçµ¦å“¥å“¥10å¼µå¾Œï¼Œå“¥å“¥çš„å¼µæ•¸å°±æ˜¯å¼Ÿå¼Ÿçš„2å€ï¼›<br>è‹¥å“¥å“¥çµ¦å¼Ÿå¼Ÿ10å¼µå¾Œï¼Œå…©äººçš„å¼µæ•¸å°±ä¸€æ¨£å¤šã€‚<br>å‡è¨­å“¥å“¥çš„å¼µæ•¸ç‚ºxå¼µï¼Œå“¥å“¥çš„å¼µæ•¸ç‚ºyå¼µï¼š<br><br>"+
                      "<ul>ï¼ˆ1ï¼‰è«‹åˆ—å‡ºè¯ç«‹æ–¹ç¨‹å¼ï¼ˆç”¨åŠå½¢é€—è™Ÿé–“éš”å…©å¼ï¼‰ï¼š&ensp;<input type = 'text' id = 'A7'><br><br>"+
                      "ï¼ˆ2ï¼‰ï¼ˆx,yï¼‰ï¼&ensp;<input type = 'text' id = 'A8'><br></ul></ul><br><br>",
                      "<ul>æœ‰ä¸€è¯ç«‹æ–¹ç¨‹å¼å¦‚åœ–<img src = 'testimg_7.png' id = 'testImg7' width = '150px' height = '90px'>ï¼Œè«‹æ±‚å‡ºå…¶è§£ç‚ºä½•ï¼Ÿ<br><br>"+
                      "<ul>ï¼ˆ1ï¼‰aï¼&ensp;<input type = 'text' id = 'A9'><br><br>"+
                      "ï¼ˆ2ï¼‰bï¼&ensp;<input type = 'text' id = 'A10'><br></ul></ul><br>",];
            var ans = ['D','C','B',"17x+19","x-3y=-10,x-2y=0","(20,10)","x-2y=-30,x-y=20","(70,50)","-36","-60"];
                     
            window.onload = function() {
                var UserName = document.getElementById("UserName");
                UserName.innerHTML = localStorage.getItem("username");
                // è®€å–é€²åº¦æ¯”ä¾‹
                const progressRate = localStorage.getItem("progress_rate");
                // è‹¥ç„¡å„²å­˜é€²åº¦ï¼Œå‰‡é è¨­ç‚º 0%
                let progress = progressRate ? parseInt(progressRate) : 0;
            
                // æ›´æ–°é€²åº¦
                updateProgress(progress);

                // æ›´æ–°é€²åº¦æ¢
                updateProgressBar(progress);
                index = 0;
                show();
            }

            // ä½¿ç”¨è€…å¤§é ­è²¼å’Œæ–‡å­—çš„é¸å–®
            document.addEventListener('DOMContentLoaded', () => {
                const userMenu = document.querySelector('.user-menu');
                const menu = document.querySelector('.user-menu .menu');

                let timer;

                userMenu.addEventListener("mouseenter", () => {
                    clearTimeout(timer);
                    menu.style.display = "block";
                });

                userMenu.addEventListener("mouseleave", () => {
                    timer = setTimeout(() => {
                        menu.style.display = "none";
                    }, 200); // å»¶é² 200ms é˜²æ­¢ä¸ç©©å®š
                });

                menu.addEventListener("mouseenter", () => {
                    clearTimeout(timer);
                    menu.style.display = "block";
                });

                menu.addEventListener("mouseleave", () => {
                    timer = setTimeout(() => {
                        menu.style.display = "none";
                    }, 200);
                });
            });
            
            // ç™»å‡º
            function leave() {
                var confirmLogout = confirm("ä½ ç¢ºå®šè¦ç™»å‡ºå—?"); 
                if(confirmLogout) {
                    window.location.href = "Login.html"; 
                }
            }

            // æ¨¡æ…‹è¦–çª—é¡¯ç¤ºèˆ‡é—œé–‰ï¼ˆéš±è—ï¼‰
            function showModal_check() {
                document.getElementById("Modal-check").style.display = "flex"; 
            }

            function closeModal_check() {
                document.getElementById("Modal-check").style.display = "none"; 
            }

            function timeSet1() {
                document.getElementById('time').innerHTML = sec;
                TimerID = window.setInterval((()=>{sec++; document.getElementById('time').innerHTML = sec;}), 1000);
            }
 
            function timeSet2() {
                let countdown = 10; // æ¯é¡Œå€’æ•¸ 10 ç§’
                document.getElementById('CountDown').innerHTML = countdown;

                // å•Ÿå‹•å€’æ•¸è¨ˆæ™‚å™¨
                CountDownID = window.setInterval(() => {
                    if (countdown > 0) {
                        countdown--; // å€’æ•¸æ™‚é–“æ¸›å°‘
                        document.getElementById('CountDown').innerHTML = countdown;
                    } 
                    else {
                        // ç•¶å€’æ•¸çµæŸï¼Œè‡ªå‹•è·³åˆ°ä¸‹ä¸€é¡Œ
                        window.clearInterval(CountDownID); // åœæ­¢å€’æ•¸è¨ˆæ™‚å™¨
                        if(order[index] == 4) {
                            correctAnswer = ans[4] + " / " + ans[5];
                        }
                        else if(order[index] == 5) {
                            correctAnswer = ans[6] + " / " + ans[7];
                        }
                        else if(order[index] == 6) {
                            correctAnswer = ans[8] + " / " + ans[9];
                        }
                        else {
                            correctAnswer = ans[order[index]];
                        }

                        learningRecord += Q[order[index]] + "<br>ä½ çš„ç­”æ¡ˆï¼š " + " " + "<br>æ­£ç¢ºç­”æ¡ˆï¼š " + correctAnswer + "<br><hr>";
                        next2(); // è·³åˆ°ä¸‹ä¸€é¡Œ
                    }
                }, 1000); // æ¯ç§’åŸ·è¡Œä¸€æ¬¡
            }

            function show() {
                var content1 = document.getElementById("content1");
                var content2 = document.getElementById("content2");
                content1.innerHTML = arr1[0];
                content2.innerHTML = arr2[0];
            }

            function NormalVersion() {
                content1.innerHTML = arr1[1];
                score = 0; // åˆ†æ•¸é‡ç½®
                document.getElementById('count').innerHTML = 'ç›®å‰ç´¯è¨ˆåˆ†æ•¸ï¼š0åˆ†'; // é¡¯ç¤ºé‡ç½®
                timeSet1();
                RandomOrder();
            }

            function timeLimitVersion() {
                content1.innerHTML = arr1[2];
                score = 0; // åˆ†æ•¸é‡ç½®
                document.getElementById('count').innerHTML = 'ç›®å‰ç´¯è¨ˆåˆ†æ•¸ï¼š0åˆ†'; // é¡¯ç¤ºé‡ç½®
                timeSet1();
                timeSet2();
                RandomOrder();
            }

            function RandomOrder() {
                for (var i = 0; i < 7; i++) {
                    let num;
                    do {
                        num = Math.floor(Math.random() * 7); // ç”¢ç”Ÿ 0~7 çš„äº‚æ•¸
                    } while (order.includes(num)); // æª¢æŸ¥æ˜¯å¦é‡è¤‡
                    order[i] = num; // å¦‚æœä¸é‡è¤‡ï¼ŒåŠ å…¥é™£åˆ—
                }
                index = 0;
                document.getElementById('check').disabled = false;
                document.getElementById('next').disabled = true;
                showQuestion();
            }

            function showQuestion() {
                content2.innerHTML = Q[order[index]];
            }

            function next1() {
                index++;
                document.getElementById('check').disabled = false;
                document.getElementById('next').disabled = true;
                // æ¸…é™¤å›é¥‹æ–‡å­—
                document.getElementById("feedback").innerHTML = "å›é¥‹ï¼š ";
                tmpString = "";
                correctAnswer = "";
                showQuestion();
            }

            function next2() {
                index++;
                // ç•¶é‚„æœ‰é¡Œç›®æ™‚ï¼Œé‡æ–°é–‹å§‹å€’æ•¸è¨ˆæ™‚
                if (index < order.length) {
                    timeSet2(); // é–‹å§‹æ–°çš„å€’æ•¸
                    document.getElementById('check').disabled = false;
                    document.getElementById('next').disabled = true;
                    // æ¸…é™¤å›é¥‹æ–‡å­—
                    document.getElementById("feedback").innerHTML = "å›é¥‹ï¼š ";
                    tmpString = "";
                    correctAnswer = "";
                    showQuestion(); 
                }
                else {
                    window.clearInterval(TimerID);
                    window.clearInterval(CountDownID);
                    document.getElementById('check').disabled = true;
                    document.getElementById('next').disabled = true;
                    localStorage.setItem("score", score);
                    localStorage.setItem("learningRecord", learningRecord);
                    localStorage.setItem("testTime", sec);
                    document.getElementById('AfterTest').innerHTML = 
                        "æŒ‘æˆ°çµæŸå›‰ï¼ä¾†çœ‹çœ‹å‰›å‰›æŒ‘æˆ°çš„ç´€éŒ„å§ï¼<br><button id='Correct_And_goBack' onclick=\"window.location='level5.html';\">é‡æ–°æŒ‘æˆ°</button>" +
                        "<button id='Correct_And_goNext' onclick=\"window.location='Record.html';\">å­¸ç¿’è¨˜éŒ„</button>";
                    showModal_check();
                }
                
            }

            //æª¢æŸ¥ç­”æ¡ˆ
            function check1() {
                // å›é¥‹æ–‡å­—å€åŸŸ
                var feedback = document.getElementById("feedback");
                var correct = 0;
                if(index + 1 < 7) {
                    document.getElementById('check').disabled = true;
                    document.getElementById('next').disabled = false;
                }
                else {
                    document.getElementById('check').disabled = true;
                    document.getElementById('next').disabled = true;
                    window.clearInterval(TimerID);
                }

                // å°æ–¼é¸æ“‡é¡Œ
                if(order[index] < 3) {
                    var form = document.getElementById('A' + (order[index] + 1));
                    correctAnswer = ans[order[index]];
                    for(var i = 0; i < form.options.length; i++) {
                        if(form.options[i].checked) {
                            tmpString = form.options[i].value;
                        }
                        if(form.options[i].checked && form.options[i].value == ans[order[index]]) {
                            correct = 1;
                            feedback.innerHTML = "å›é¥‹ï¼š æ­å–œç­”å°ï¼ğŸ‰";
                            break;
                        }
                        if(i == 3){
                            feedback.innerHTML = "å›é¥‹ï¼š å¥½å¯æƒœï¼Œç­”éŒ¯äº†ğŸ˜¢";
                        }
                    }
                } 
                // æª¢æŸ¥æ˜¯å¦éœ€è¦å¤šæ ¼ç­”æ¡ˆï¼ˆç¬¬4é¡Œï¼‰
                else if (order[index] == 4) { 
                    // å¤šæ ¼ç­”æ¡ˆçš„è™•ç†
                    var answer1 = document.getElementById('A5').value.trim();
                    var answer2 = document.getElementById('A6').value.trim();

                    correctAnswer = ans[4] + " / " + ans[5];
                    tmpString = answer1 + " / " + answer2;

                    var firstCorrect = (answer1 == ans[4]);
                    var secondCorrect = (answer2 == ans[5]);

                    if (firstCorrect && secondCorrect) {
                        correct = 2; // å…¨å°
                        feedback.innerHTML = "å›é¥‹ï¼š å“‡ï¼çœŸå²å®³ï¼Œå…©å°é¡Œéƒ½ç­”å°äº†ï¼ğŸ‰";
                    } 
                    else if (firstCorrect || secondCorrect) {
                        correct = 1; // éƒ¨åˆ†æ­£ç¢º
                        feedback.innerHTML = "å›é¥‹ï¼š å¾ˆæ£’ï¼Œç­”å°ä¸€å°é¡Œå“¦ï¼ğŸ‰";
                    }
                    else {
                        feedback.innerHTML = "å›é¥‹ï¼š å¥½å¯æƒœï¼Œç­”éŒ¯äº†ğŸ˜¢";
                    }
                } 
                // æª¢æŸ¥æ˜¯å¦éœ€è¦å¤šæ ¼ç­”æ¡ˆï¼ˆç¬¬5é¡Œï¼‰
                else if (order[index] == 5) {
                    var answer1 = document.getElementById('A7').value.trim();
                    var answer2 = document.getElementById('A8').value.trim();

                    correctAnswer = ans[6] + " / " + ans[7];
                    tmpString = answer1 + " / " + answer2;

                    var firstCorrect = (answer1 == ans[6]);
                    var secondCorrect = (answer2 == ans[7]);

                    if (firstCorrect && secondCorrect) {
                        correct = 2; // å…¨å°
                        feedback.innerHTML = "å›é¥‹ï¼š å“‡ï¼çœŸå²å®³ï¼Œå…©å°é¡Œéƒ½ç­”å°äº†ï¼ğŸ‰";
                    } 
                    else if (firstCorrect || secondCorrect) {
                        correct = 1; // éƒ¨åˆ†æ­£ç¢º
                        feedback.innerHTML = "å›é¥‹ï¼š å¾ˆæ£’ï¼Œç­”å°ä¸€å°é¡Œå“¦ï¼ğŸ‰"
                    }
                    else {
                        feedback.innerHTML = "å›é¥‹ï¼š å¥½å¯æƒœï¼Œç­”éŒ¯äº†ğŸ˜¢";
                    }
                } 
                // æª¢æŸ¥æ˜¯å¦éœ€è¦å¤šæ ¼ç­”æ¡ˆï¼ˆç¬¬6é¡Œï¼‰
                else if (order[index] == 6) { 
                    // å¤šæ ¼ç­”æ¡ˆçš„è™•ç†
                    var answer1 = document.getElementById('A9').value.trim();
                    var answer2 = document.getElementById('A10').value.trim();

                    correctAnswer = ans[8] + " / " + ans[9];
                    tmpString = answer1 + " / " + answer2;

                    var firstCorrect = (answer1 == ans[8]);
                    var secondCorrect = (answer2 == ans[9]);

                    if (firstCorrect && secondCorrect) {
                        correct = 2; // å…¨å°
                        feedback.innerHTML = "å›é¥‹ï¼š å“‡ï¼çœŸå²å®³ï¼Œå…©å°é¡Œéƒ½ç­”å°äº†ï¼ğŸ‰";
                    } 
                    else if (firstCorrect || secondCorrect) {
                        correct = 1; // éƒ¨åˆ†æ­£ç¢º
                        feedback.innerHTML = "å›é¥‹ï¼š å¾ˆæ£’ï¼Œç­”å°ä¸€å°é¡Œå“¦ï¼ğŸ‰";
                    }
                    else {
                        feedback.innerHTML = "å›é¥‹ï¼š å¥½å¯æƒœï¼Œç­”éŒ¯äº†ğŸ˜¢";
                    }
                }
                // å°æ–¼å¡«ç©ºé¡Œ
                else {
                    var answer = document.getElementById('A' + (order[index] + 1)).value.trim();
                    
                    correctAnswer = ans[order[index]];
                    tmpString = answer;

                    if(answer == ans[order[index]]) {
                        correct = 1;
                        feedback.innerHTML = "å›é¥‹ï¼š æ­å–œç­”å°ï¼ğŸ‰";
                    }
                    else {
                        feedback.innerHTML = "å›é¥‹ï¼š å¥½å¯æƒœï¼Œç­”éŒ¯äº†ğŸ˜¢";
                    }
                }

                // æ›´æ–°åˆ†æ•¸
                score += 10 * correct;
                document.getElementById('count').innerHTML = "ç›®å‰ç´¯è¨ˆåˆ†æ•¸ï¼š"+score+"åˆ†";
                learningRecord += Q[order[index]] + "<br>ä½ çš„ç­”æ¡ˆï¼š " + tmpString + "<br>æ­£ç¢ºç­”æ¡ˆï¼š " + correctAnswer + "<br><hr>";

                if(index + 1 >= 7){
                    localStorage.setItem("score", score);
                    localStorage.setItem("learningRecord", learningRecord);
                    localStorage.setItem("testTime", sec);
                    localStorage.setItem("progress_rate", "100%");
                    document.getElementById('AfterTest').innerHTML = 
                            "æŒ‘æˆ°çµæŸå›‰ï¼ä¾†çœ‹çœ‹å‰›å‰›æŒ‘æˆ°çš„ç´€éŒ„å§ï¼<br><button id='Correct_And_goBack' onclick=\"window.location='level5.html';\">é‡æ–°æŒ‘æˆ°</button>" +
                            "<button id='Correct_And_goNext' onclick=\"window.location='Record.html';\">å­¸ç¿’è¨˜éŒ„</button>";
                    showModal_check();
                }
            }

            //æª¢æŸ¥ç­”æ¡ˆ
            function check2() {
                var feedback = document.getElementById("feedback");
                window.clearInterval(CountDownID); // åœæ­¢å€’æ•¸è¨ˆæ™‚å™¨
                if(index + 1 < 7) {
                    document.getElementById('check').disabled = true;
                    document.getElementById('next').disabled = false;
                }
                else {
                    document.getElementById('check').disabled = true;
                    document.getElementById('next').disabled = true;
                    window.clearInterval(TimerID);
                }
                var correct = 0;

                // å°æ–¼é¸æ“‡é¡Œ
                if(order[index] < 3) {
                    var form = document.getElementById('A' + (order[index] + 1));
                    correctAnswer = ans[order[index]];
                    for(var i = 0; i < form.options.length; i++) {
                        if(form.options[i].checked) {
                            tmpString = form.options[i].value;
                        }
                        if(form.options[i].checked && form.options[i].value == ans[order[index]]) {
                            correct = 1;
                            feedback.innerHTML = "å›é¥‹ï¼š æ­å–œç­”å°ï¼ğŸ‰";
                            break;
                        }
                        if(i == 3){
                            feedback.innerHTML = "å›é¥‹ï¼š å¥½å¯æƒœï¼Œç­”éŒ¯äº†ğŸ˜¢";
                        }
                    }
                } 
                // æª¢æŸ¥æ˜¯å¦éœ€è¦å¤šæ ¼ç­”æ¡ˆï¼ˆç¬¬4é¡Œï¼‰
                else if (order[index] == 4) { 
                    // å¤šæ ¼ç­”æ¡ˆçš„è™•ç†
                    var answer1 = document.getElementById('A5').value.trim();
                    var answer2 = document.getElementById('A6').value.trim();

                    correctAnswer = ans[4] + " / " + ans[5];
                    tmpString = answer1 + " / " + answer2;

                    var firstCorrect = (answer1 == ans[4]);
                    var secondCorrect = (answer2 == ans[5]);

                    if (firstCorrect && secondCorrect) {
                        correct = 2; // å…¨å°
                        feedback.innerHTML = "å›é¥‹ï¼š å“‡ï¼çœŸå²å®³ï¼Œå…©å°é¡Œéƒ½ç­”å°äº†ï¼ğŸ‰";
                    } 
                    else if (firstCorrect || secondCorrect) {
                        correct = 1; // éƒ¨åˆ†æ­£ç¢º
                        feedback.innerHTML = "å›é¥‹ï¼š å¾ˆæ£’ï¼Œç­”å°ä¸€å°é¡Œå“¦ï¼ğŸ‰";
                    }
                    else {
                        feedback.innerHTML = "å›é¥‹ï¼š å¥½å¯æƒœï¼Œç­”éŒ¯äº†ğŸ˜¢";
                    }
                } 
                // æª¢æŸ¥æ˜¯å¦éœ€è¦å¤šæ ¼ç­”æ¡ˆï¼ˆç¬¬5é¡Œï¼‰
                else if (order[index] == 5) {
                    var answer1 = document.getElementById('A7').value.trim();
                    var answer2 = document.getElementById('A8').value.trim();

                    correctAnswer = ans[6] + " / " + ans[7];
                    tmpString = answer1 + " / " + answer2;

                    var firstCorrect = (answer1 == ans[6]);
                    var secondCorrect = (answer2 == ans[7]);

                    if (firstCorrect && secondCorrect) {
                        correct = 2; // å…¨å°
                        feedback.innerHTML = "å›é¥‹ï¼š å“‡ï¼çœŸå²å®³ï¼Œå…©å°é¡Œéƒ½ç­”å°äº†ï¼ğŸ‰";
                    } 
                    else if (firstCorrect || secondCorrect) {
                        correct = 1; // éƒ¨åˆ†æ­£ç¢º
                        feedback.innerHTML = "å›é¥‹ï¼š å¾ˆæ£’ï¼Œç­”å°ä¸€å°é¡Œå“¦ï¼ğŸ‰";
                    }
                    else {
                        feedback.innerHTML = "å›é¥‹ï¼š å¥½å¯æƒœï¼Œç­”éŒ¯äº†ğŸ˜¢";
                    }
                } 
                // æª¢æŸ¥æ˜¯å¦éœ€è¦å¤šæ ¼ç­”æ¡ˆï¼ˆç¬¬6é¡Œï¼‰
                else if (order[index] == 6) { 
                    // å¤šæ ¼ç­”æ¡ˆçš„è™•ç†
                    var answer1 = document.getElementById('A9').value.trim();
                    var answer2 = document.getElementById('A10').value.trim();

                    correctAnswer = ans[8] + " / " + ans[9];
                    tmpString = answer1 + " / " + answer2;

                    var firstCorrect = (answer1 == ans[8]);
                    var secondCorrect = (answer2 == ans[9]);

                    if (firstCorrect && secondCorrect) {
                        correct = 2; // å…¨å°
                        feedback.innerHTML = "å›é¥‹ï¼š å“‡ï¼çœŸå²å®³ï¼Œå…©å°é¡Œéƒ½ç­”å°äº†ï¼ğŸ‰";
                    } 
                    else if (firstCorrect || secondCorrect) {
                        correct = 1; // éƒ¨åˆ†æ­£ç¢º
                        feedback.innerHTML = "å›é¥‹ï¼š å¾ˆæ£’ï¼Œç­”å°ä¸€å°é¡Œå“¦ï¼ğŸ‰";
                    }
                    else {
                        feedback.innerHTML = "å›é¥‹ï¼š å¥½å¯æƒœï¼Œç­”éŒ¯äº†ğŸ˜¢";
                    }
                } 
                // å°æ–¼å¡«ç©ºé¡Œ
                else {
                    var answer = document.getElementById('A' + (order[index] + 1)).value.trim();

                    correctAnswer = ans[order[index]];
                    tmpString = answer;

                    if(answer == ans[order[index]]) {
                        correct = 1;
                        feedback.innerHTML = "å›é¥‹ï¼š æ­å–œç­”å°ï¼ğŸ‰";
                    }
                    else {
                        feedback.innerHTML = "å›é¥‹ï¼š å¥½å¯æƒœï¼Œç­”éŒ¯äº†ğŸ˜¢";
                    }
                }

                // æ›´æ–°åˆ†æ•¸
                score += 10 * correct;
                document.getElementById('count').innerHTML = "ç›®å‰ç´¯è¨ˆåˆ†æ•¸ï¼š"+score+"åˆ†";
                learningRecord += Q[order[index]] + "<br>ä½ çš„ç­”æ¡ˆï¼š " + tmpString + "<br>æ­£ç¢ºç­”æ¡ˆï¼š " + correctAnswer + "<br><hr>";

                if(index + 1 >= 7) {
                    learningRecord += Q[order[index]] + "<br>ä½ çš„ç­”æ¡ˆï¼š " + tmpString + "<br>æ­£ç¢ºç­”æ¡ˆï¼š " + correctAnswer + "<br><hr>";
                    localStorage.setItem("score", score);
                    localStorage.setItem("learningRecord", learningRecord);
                    localStorage.setItem("testTime", sec);
                    localStorage.setItem("progress_rate", "100%");
                    document.getElementById('AfterTest').innerHTML = 
                        "æŒ‘æˆ°çµæŸå›‰ï¼ä¾†çœ‹çœ‹å‰›å‰›æŒ‘æˆ°çš„ç´€éŒ„å§ï¼<br><button id='Correct_And_goBack' onclick=\"window.location='level5.html';\">é‡æ–°æŒ‘æˆ°</button>" +
                        "<button id='Correct_And_goNext' onclick=\"window.location='Record.html';\">å­¸ç¿’è¨˜éŒ„</button>";
                    showModal_check();
                }
            }
            
            function updateProgress(progress) {
                localStorage.setItem("progress", progress); // ä¿å­˜é€²åº¦
                const progressBar = document.getElementById("ProgressBar");
                const progressPercentage = document.getElementById("ProgressPercentage");

                // æ›´æ–°é€²åº¦æ¢å¯¬åº¦
                progressBar.style.width = progress + "%";

                // æ›´æ–°ç™¾åˆ†æ¯”æ–‡å­—
                progressPercentage.innerText = progress + "%";

                // åˆ¤æ–·æ˜¯å¦ç‚º100%
                if (progress >= 100) {
                    progressBar.classList.add("full"); // æ·»åŠ  full é¡
                } 
                else {
                    progressBar.classList.remove("full"); // ç§»é™¤ full é¡ï¼ˆé100%æƒ…æ³ï¼‰
                }
            }

            function updateProgressBar(progress) {
                const progressBar = document.getElementById("ProgressBar");

                // è¨­å®šé€²åº¦æ¢å¯¬åº¦ï¼ˆæ¯”ä¾‹ï¼‰
                if (progressBar) {
                    progressBar.style.width = `${progress}%`;
                    progressBar.style.backgroundColor = "#a1f5d7"; // è¨­å®šé€²åº¦æ¢é¡è‰²
                }
            }
        </script>
    </head>
    <body>
        <header>
            <h1>äºŒå…ƒä¸€æ¬¡æ–¹ç¨‹å¼</h1>
            <div class="header-right">
                <div class="progress-bar-container-wrapper">
                    <span class="progress-label">å­¸ç¿’é€²åº¦ï¼š</span> <!-- æ–°å¢çš„æ¨™ç±¤ï¼Œæ”¾åœ¨å®¹å™¨å¤– -->
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="ProgressBar"></div>
                        <span class="progress-percentage" id="ProgressPercentage">0%</span>
                    </div>
                </div>
                <div class="user-menu">
                    <img src="User.png">
                    <span id="UserName">U123</span>
                    <div class="menu">
                        <a href="Record.html">å­¸ç¿’è¨˜éŒ„</a>
                        <a href="Addition.html">è£œå……è³‡æ–™</a>
                        <a href="#" onclick="leave();">ç™»å‡º</a>
                    </div>
                </div>
            </div>
        </header>

        <div class="container">
            <button class = "Back" onclick = "window.location = 'HomePage.html';">å›ä¸»é </button>
            <div class = "Title">çµ‚æ¥µæŒ‘æˆ°</div>
            <div id = "content1"></div>
            <div id = "content2"></div>
            <div id = "Modal-check" class = "modal-check">
                <div class = "modal-content">
                    <span class = "close" onclick = "closeModal_check();">x</span>
                    <p id = 'AfterTest'></p>
                </div>
            </div>
        </div>
    </body>
</html>
